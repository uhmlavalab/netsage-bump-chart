<!DOCTYPE html>
<meta charset="utf-8">

<script src="//d3js.org/d3.v4.min.js"></script>
<script>

    //This is the soccer one!  We can use at least some of it to start.

    ///////////////////////
    // Parse the Data

    ///////////////////////
    // Chart Size Setup
    var margin = { top: 35, right: 0, bottom: 30, left: 70 };

    var width = 960 - margin.left - margin.right;
    var height = 500 - margin.top - margin.bottom;

    var chart = d3.select(".chart")
        .attr("width", 960)
        .attr("height", 500)
        .append("g")
        .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

    ///////////////////////
    // Scales
    // var x = d3.scaleBand()
    //     .domain(data.map(function (d) { return d['year']; }).reverse())
    //     .rangeRound([25, width - 15]);

    // var y = d3.scaleLinear()
    //     .domain([d3.min(data, function (d) { return d['position'] }), d3.max(data, function (d) { return d['position']; })])
    //     .range([20, height - 30]);

    // var size = d3.scaleLinear()
    //     .domain(d3.extent(data, function (d) { return d['goals_for']; }))
    //     .range([3, 10]);

    ///////////////////////
    // Axis
    var xAxis = d3.axisBottom(x);

    var yAxis = d3.axisLeft(y);

    chart.append("g")
        .attr("class", "x axis")
        .attr("transform", "translate(-" + x.bandwidth() / 2.0 + "," + height + ")")
        .call(xAxis);

    chart.append("g")
        .attr("class", "y axis")
        .call(yAxis);

    ///////////////////////
    // Title
    chart.append("text")
        .text('Top Talker Organizations (hover over a dot to focus, click to keep focus)')
        .attr("text-anchor", "middle")
        .attr("class", "graph-title")
        .attr("y", -10)
        .attr("x", width / 2.0);

    chart.append("text")
        .text('Current Position')
        .attr("text-anchor", "middle")
        .attr("class", "graph-title")
        .attr("y", -35)
        .attr("x", width / -4.0)
        .attr("transform", "rotate(-90)");

    ///////////////////////
    // Lines
    var clubs = d3.map(data, function (d) {
        return d['club'];
    }).keys();

    // clubs.forEach(function (club) {
    //     var currData = data.filter(function (d) {
    //         if (d['club'] == club) {
    //             return d;
    //         }
    //     });

    //     var line = d3.line()
    //         .x(function (d) { return x(d['year']); })
    //         .y(function (d) { return y(d['position']); });

    //     chart.append("path")
    //         .datum(currData)
    //         .attr("class", club.toLowerCase().replace(/ /g, '-').replace(/\./g, ''))
    //         .attr("style", "fill:none !important")
    //         .attr("stroke-linejoin", "round")
    //         .attr("stroke-linecap", "round")
    //         .attr("stroke-width", 2)
    //         .attr("stroke-opacity", 0.1)
    //         .attr("d", line);
    // });

    ///////////////////////
    // Nodes
    // var node = chart.append("g")
    //     .selectAll("circle")
    //     .data(data)
    //     .enter().append("circle")
    //     .attr("class", "point")
    //     .attr("cx", function (d) { return x(d['year']); })
    //     .attr("cy", function (d) { return y(d['position']); })
    //     .attr('fill', 'blue')
    //     // replace spaces with - and remove '.' (from d.c. united)
    //     .attr("class", function (d) { return d['club'].toLowerCase().replace(/ /g, '-').replace(/\./g, '') })
    //     .attr("r", 6)
    //     //.attr("r", function(d) { return size(d['goals_for']) })
    //     .attr("stroke-width", 1.5)
    //     .attr('opacity', '0.6');

    ///////////////////////
    // Tooltips
    var tooltip = d3.select("body").append("div")
        .attr("class", "tooltip");

        // chart.selectAll("circle")
        //     .on("mouseover", function (d) {
        //         chart.selectAll('.' + d['class'])
        //             .classed('active', true);

        //         var tooltip_str = "Club: " + d['club'] +
        //             "<br/>" + "Year: " + d['year'] +
        //             "<br/>" + "Points: " + d['points'] +
        //             "<br/>" + "W/L/T: " + d['wins'] + " / " + d['losses'] + " / " + d['ties'] +
        //             "<br/>" + "Goals F/A: " + d['goals_for'] + " / " + d['goals_against'];

        //         if (d['alias'] != '') {
        //             tooltip_str += "<br/>(aka: " + d['alias'] + ")";
        //         }

        //         tooltip.html(tooltip_str)
        //             .style("visibility", "visible");
        //     })
        //     .on("mousemove", function (d) {
        //         tooltip.style("top", event.pageY - (tooltip.node().clientHeight + 5) + "px")
        //             .style("left", event.pageX - (tooltip.node().clientWidth / 2.0) + "px");
        //     })
        //     .on("mouseout", function (d) {
        //         chart.selectAll('.' + d['class'])
        //             .classed('active', false);

        //         tooltip.style("visibility", "hidden");
        //     })
        //     .on('click', function (d) {
        //         chart.selectAll('.' + d['class'])
        //             .classed('click-active', function (d) {
        //                 // toggle state
        //                 return !d3.select(this).classed('click-active');
        //             });
        //     })

</script>

<style>
    .click-active,
    .active {
        opacity: 1.0;
        stroke-opacity: 1.0;
        z-index: 1000;
        /*r: 8;*/
    }

    path.click-active {
        stroke-width: 3.0;
    }

    path.active {
        stroke-width: 3.0;
    }

    .axis text {
        font: 10px sans-serif;
    }

    .axis path,
    .axis line {
        fill: none;
        stroke: #000;
        shape-rendering: crispEdges;
    }

    .x.axis path {
        display: none;
    }

    .tooltip {
        position: absolute;
        padding: 10px;
        font: 12px sans-serif;
        background: #222;
        color: #fff;
        border: 0px;
        border-radius: 8px;
        pointer-events: none;
        opacity: 0.9;
        visibility: hidden;
    }

</style>

<body>
    <svg class="chart"></svg>
</body>
