data = {
    "buckets": [
        {
            "key": "University Corporation for Atmospheric Research",
            "doc_count": 40520009,
            "1": {
                "value": 2.86257160512798144E17
            },
            "2": {
                "buckets": [
                    {
                        "key_as_string": "1572566400000",
                        "key": 1572566400000,
                        "doc_count": 1906860,
                        "1": {
                            "value": 1.453511506209914E15
                        }
                    },
                    {
                        "key_as_string": "1575158400000",
                        "key": 1575158400000,
                        "doc_count": 8845972,
                        "1": {
                            "value": 6.52497840128713E15
                        }
                    },
                    {
                        "key_as_string": "1577836800000",
                        "key": 1577836800000,
                        "doc_count": 8793526,
                        "1": {
                            "value": 8.005805207191859E15
                        }
                    },
                    {
                        "key_as_string": "1580515200000",
                        "key": 1580515200000,
                        "doc_count": 3130396,
                        "1": {
                            "value": 4.05640589484544E15
                        }
                    },
                    {
                        "key_as_string": "1583020800000",
                        "key": 1583020800000,
                        "doc_count": 7912176,
                        "1": {
                            "value": 7.266899378056735E15
                        }
                    },
                    {
                        "key_as_string": "1585699200000",
                        "key": 1585699200000,
                        "doc_count": 8581867,
                        "1": {
                            "value": 6.789329692347537E15
                        }
                    },
                    {
                        "key_as_string": "1588291200000",
                        "key": 1588291200000,
                        "doc_count": 1349212,
                        "1": {
                            "value": 1.685214984161155E15
                        }
                    }
                ]
            }
        },
        {
            "key": "Fermi National Accelerator Laboratory (Fermilab)",
            "doc_count": 58172665,
            "1": {
                "value": 2.50231706547396416E17
            },
            "2": {
                "buckets": [
                    {
                        "key_as_string": "1572566400000",
                        "key": 1572566400000,
                        "doc_count": 5186590,
                        "1": {
                            "value": 1.490089642142881E15
                        }
                    },
                    {
                        "key_as_string": "1575158400000",
                        "key": 1575158400000,
                        "doc_count": 21151121,
                        "1": {
                            "value": 7.463705971726216E15
                        }
                    },
                    {
                        "key_as_string": "1577836800000",
                        "key": 1577836800000,
                        "doc_count": 15527960,
                        "1": {
                            "value": 9.086531127800398E15
                        }
                    },
                    {
                        "key_as_string": "1580515200000",
                        "key": 1580515200000,
                        "doc_count": 5495638,
                        "1": {
                            "value": 4.341683311749656E15
                        }
                    },
                    {
                        "key_as_string": "1583020800000",
                        "key": 1583020800000,
                        "doc_count": 4466185,
                        "1": {
                            "value": 3.746579111841587E15
                        }
                    },
                    {
                        "key_as_string": "1585699200000",
                        "key": 1585699200000,
                        "doc_count": 4690184,
                        "1": {
                            "value": 4.179537931873878E15
                        }
                    },
                    {
                        "key_as_string": "1588291200000",
                        "key": 1588291200000,
                        "doc_count": 1654987,
                        "1": {
                            "value": 9.70836221289937E14
                        }
                    }
                ]
            }
        },
        {
            "key": "UltraLight",
            "doc_count": 24977881,
            "1": {
                "value": 1.56375326774001792E17
            },
            "2": {
                "buckets": [
                    {
                        "key_as_string": "1572566400000",
                        "key": 1572566400000,
                        "doc_count": 1586411,
                        "1": {
                            "value": 1.369990712129536E15
                        }
                    },
                    {
                        "key_as_string": "1575158400000",
                        "key": 1575158400000,
                        "doc_count": 13641328,
                        "1": {
                            "value": 7.708436657688576E15
                        }
                    },
                    {
                        "key_as_string": "1577836800000",
                        "key": 1577836800000,
                        "doc_count": 6022069,
                        "1": {
                            "value": 6.86874177010519E15
                        }
                    },
                    {
                        "key_as_string": "1580515200000",
                        "key": 1580515200000,
                        "doc_count": 1040996,
                        "1": {
                            "value": 9.16447278531708E14
                        }
                    },
                    {
                        "key_as_string": "1583020800000",
                        "key": 1583020800000,
                        "doc_count": 1553065,
                        "1": {
                            "value": 1.788575228109824E15
                        }
                    },
                    {
                        "key_as_string": "1585699200000",
                        "key": 1585699200000,
                        "doc_count": 984603,
                        "1": {
                            "value": 7.7851796853355E14
                        }
                    },
                    {
                        "key_as_string": "1588291200000",
                        "key": 1588291200000,
                        "doc_count": 149409,
                        "1": {
                            "value": 1.1620623165184E14
                        }
                    }
                ]
            }
        },
        {
            "key": "California State University, Office of the Chancellor",
            "doc_count": 18528233,
            "1": {
                "value": 1.2281121249280816E17
            },
            "2": {
                "buckets": [
                    {
                        "key_as_string": "1572566400000",
                        "key": 1572566400000,
                        "doc_count": 476030,
                        "1": {
                            "value": 1.87640194341725E14
                        }
                    },
                    {
                        "key_as_string": "1575158400000",
                        "key": 1575158400000,
                        "doc_count": 4447688,
                        "1": {
                            "value": 1.980264932844567E15
                        }
                    },
                    {
                        "key_as_string": "1577836800000",
                        "key": 1577836800000,
                        "doc_count": 5851050,
                        "1": {
                            "value": 6.098388028938886E15
                        }
                    },
                    {
                        "key_as_string": "1580515200000",
                        "key": 1580515200000,
                        "doc_count": 2852962,
                        "1": {
                            "value": 2.570141267203316E15
                        }
                    },
                    {
                        "key_as_string": "1583020800000",
                        "key": 1583020800000,
                        "doc_count": 2568968,
                        "1": {
                            "value": 2.286018919965489E15
                        }
                    },
                    {
                        "key_as_string": "1585699200000",
                        "key": 1585699200000,
                        "doc_count": 1914411,
                        "1": {
                            "value": 1.834462157195126E15
                        }
                    },
                    {
                        "key_as_string": "1588291200000",
                        "key": 1588291200000,
                        "doc_count": 417124,
                        "1": {
                            "value": 3.94486061111912E14
                        }
                    }
                ]
            }
        },
        {
            "key": "FUNDAÇÃO DE AMPARO À PESQUISA DO ESTADO SÃO PAULO",
            "doc_count": 59460677,
            "1": {
                "value": 1.14576549561555136E17
            },
            "2": {
                "buckets": [
                    {
                        "key_as_string": "1572566400000",
                        "key": 1572566400000,
                        "doc_count": 7736379,
                        "1": {
                            "value": 1.51145193651484E15
                        }
                    },
                    {
                        "key_as_string": "1575158400000",
                        "key": 1575158400000,
                        "doc_count": 9353257,
                        "1": {
                            "value": 2.056916480201216E15
                        }
                    },
                    {
                        "key_as_string": "1577836800000",
                        "key": 1577836800000,
                        "doc_count": 15257425,
                        "1": {
                            "value": 3.487051666624E15
                        }
                    },
                    {
                        "key_as_string": "1580515200000",
                        "key": 1580515200000,
                        "doc_count": 15853692,
                        "1": {
                            "value": 4.948693901604352E15
                        }
                    },
                    {
                        "key_as_string": "1583020800000",
                        "key": 1583020800000,
                        "doc_count": 4093353,
                        "1": {
                            "value": 5.36850845994496E14
                        }
                    },
                    {
                        "key_as_string": "1585699200000",
                        "key": 1585699200000,
                        "doc_count": 5841510,
                        "1": {
                            "value": 1.494547589196288E15
                        }
                    },
                    {
                        "key_as_string": "1588291200000",
                        "key": 1588291200000,
                        "doc_count": 1325061,
                        "1": {
                            "value": 2.865562750592E14
                        }
                    }
                ]
            }
        },
        {
            "key": "Jisc Services Limited",
            "doc_count": 24154510,
            "1": {
                "value": 1.13599392965083104E17
            },
            "2": {
                "buckets": [
                    {
                        "key_as_string": "1572566400000",
                        "key": 1572566400000,
                        "doc_count": 5560742,
                        "1": {
                            "value": 2.28647119883783E15
                        }
                    },
                    {
                        "key_as_string": "1575158400000",
                        "key": 1575158400000,
                        "doc_count": 4056228,
                        "1": {
                            "value": 2.611017362654828E15
                        }
                    },
                    {
                        "key_as_string": "1577836800000",
                        "key": 1577836800000,
                        "doc_count": 4587105,
                        "1": {
                            "value": 2.702474642323538E15
                        }
                    },
                    {
                        "key_as_string": "1580515200000",
                        "key": 1580515200000,
                        "doc_count": 3795343,
                        "1": {
                            "value": 2.307907330345333E15
                        }
                    },
                    {
                        "key_as_string": "1583020800000",
                        "key": 1583020800000,
                        "doc_count": 3102222,
                        "1": {
                            "value": 1.947666359982969E15
                        }
                    },
                    {
                        "key_as_string": "1585699200000",
                        "key": 1585699200000,
                        "doc_count": 2205580,
                        "1": {
                            "value": 1.885391229878566E15
                        }
                    },
                    {
                        "key_as_string": "1588291200000",
                        "key": 1588291200000,
                        "doc_count": 847290,
                        "1": {
                            "value": 4.58995996612324E14
                        }
                    }
                ]
            }
        },
        {
            "key": "NIST/U.S. Dept. of Commerce",
            "doc_count": 46528140,
            "1": {
                "value": 1.11632907302990208E17
            },
            "2": {
                "buckets": [
                    {
                        "key_as_string": "1572566400000",
                        "key": 1572566400000,
                        "doc_count": 3349220,
                        "1": {
                            "value": 7.52199177190377E14
                        }
                    },
                    {
                        "key_as_string": "1575158400000",
                        "key": 1575158400000,
                        "doc_count": 13138262,
                        "1": {
                            "value": 3.451416714377597E15
                        }
                    },
                    {
                        "key_as_string": "1577836800000",
                        "key": 1577836800000,
                        "doc_count": 12482945,
                        "1": {
                            "value": 3.576860601535815E15
                        }
                    },
                    {
                        "key_as_string": "1580515200000",
                        "key": 1580515200000,
                        "doc_count": 4586958,
                        "1": {
                            "value": 1.579188441900617E15
                        }
                    },
                    {
                        "key_as_string": "1583020800000",
                        "key": 1583020800000,
                        "doc_count": 5818448,
                        "1": {
                            "value": 2.032503049397681E15
                        }
                    },
                    {
                        "key_as_string": "1585699200000",
                        "key": 1585699200000,
                        "doc_count": 5702806,
                        "1": {
                            "value": 2.028838808432565E15
                        }
                    },
                    {
                        "key_as_string": "1588291200000",
                        "key": 1588291200000,
                        "doc_count": 1449501,
                        "1": {
                            "value": 5.33106620039123E14
                        }
                    }
                ]
            }
        },
        {
            "key": "National Energy Research Scientific Computing Center",
            "doc_count": 3024497,
            "1": {
                "value": 1.09446017163190192E17
            },
            "2": {
                "buckets": [
                    {
                        "key_as_string": "1572566400000",
                        "key": 1572566400000,
                        "doc_count": 446121,
                        "1": {
                            "value": 6.51537725333157E14
                        }
                    },
                    {
                        "key_as_string": "1575158400000",
                        "key": 1575158400000,
                        "doc_count": 666058,
                        "1": {
                            "value": 1.465136858111625E15
                        }
                    },
                    {
                        "key_as_string": "1577836800000",
                        "key": 1577836800000,
                        "doc_count": 552707,
                        "1": {
                            "value": 2.996815235607049E15
                        }
                    },
                    {
                        "key_as_string": "1580515200000",
                        "key": 1580515200000,
                        "doc_count": 509551,
                        "1": {
                            "value": 5.76759910291374E15
                        }
                    },
                    {
                        "key_as_string": "1583020800000",
                        "key": 1583020800000,
                        "doc_count": 422992,
                        "1": {
                            "value": 1.38812126221842E15
                        }
                    },
                    {
                        "key_as_string": "1585699200000",
                        "key": 1585699200000,
                        "doc_count": 266453,
                        "1": {
                            "value": 1.00264445349902E15
                        }
                    },
                    {
                        "key_as_string": "1588291200000",
                        "key": 1588291200000,
                        "doc_count": 160615,
                        "1": {
                            "value": 4.08897507715763E14
                        }
                    }
                ]
            }
        },
        {
            "key": "European Organization for Nuclear Research",
            "doc_count": 24126470,
            "1": {
                "value": 9.54780134802504E16
            },
            "2": {
                "buckets": [
                    {
                        "key_as_string": "1572566400000",
                        "key": 1572566400000,
                        "doc_count": 3226494,
                        "1": {
                            "value": 7.95415426621358E14
                        }
                    },
                    {
                        "key_as_string": "1575158400000",
                        "key": 1575158400000,
                        "doc_count": 4558056,
                        "1": {
                            "value": 1.837013459807744E15
                        }
                    },
                    {
                        "key_as_string": "1577836800000",
                        "key": 1577836800000,
                        "doc_count": 6419265,
                        "1": {
                            "value": 4.063525868558791E15
                        }
                    },
                    {
                        "key_as_string": "1580515200000",
                        "key": 1580515200000,
                        "doc_count": 4488004,
                        "1": {
                            "value": 2.043091035933886E15
                        }
                    },
                    {
                        "key_as_string": "1583020800000",
                        "key": 1583020800000,
                        "doc_count": 2126122,
                        "1": {
                            "value": 1.298408358722078E15
                        }
                    },
                    {
                        "key_as_string": "1585699200000",
                        "key": 1585699200000,
                        "doc_count": 2668071,
                        "1": {
                            "value": 1.79622639411044E15
                        }
                    },
                    {
                        "key_as_string": "1588291200000",
                        "key": 1588291200000,
                        "doc_count": 640458,
                        "1": {
                            "value": 1.01071141277003E14
                        }
                    }
                ]
            }
        },
        {
            "key": "Stanford University",
            "doc_count": 17425052,
            "1": {
                "value": 9.2510722850228832E16
            },
            "2": {
                "buckets": [
                    {
                        "key_as_string": "1572566400000",
                        "key": 1572566400000,
                        "doc_count": 408007,
                        "1": {
                            "value": 2.19804022590908E14
                        }
                    },
                    {
                        "key_as_string": "1575158400000",
                        "key": 1575158400000,
                        "doc_count": 4419900,
                        "1": {
                            "value": 2.502911385490868E15
                        }
                    },
                    {
                        "key_as_string": "1577836800000",
                        "key": 1577836800000,
                        "doc_count": 5242650,
                        "1": {
                            "value": 3.397488933959542E15
                        }
                    },
                    {
                        "key_as_string": "1580515200000",
                        "key": 1580515200000,
                        "doc_count": 2116701,
                        "1": {
                            "value": 1.371186574546626E15
                        }
                    },
                    {
                        "key_as_string": "1583020800000",
                        "key": 1583020800000,
                        "doc_count": 2273297,
                        "1": {
                            "value": 1.8993073838764E15
                        }
                    },
                    {
                        "key_as_string": "1585699200000",
                        "key": 1585699200000,
                        "doc_count": 2422876,
                        "1": {
                            "value": 1.775172116288326E15
                        }
                    },
                    {
                        "key_as_string": "1588291200000",
                        "key": 1588291200000,
                        "doc_count": 541621,
                        "1": {
                            "value": 3.97969939525934E14
                        }
                    }
                ]
            }
        },
        {
            "key": "KISTI",
            "doc_count": 14490153,
            "1": {
                "value": 7.6813859134118976E16
            },
            "2": {
                "buckets": [
                    {
                        "key_as_string": "1572566400000",
                        "key": 1572566400000,
                        "doc_count": 191457,
                        "1": {
                            "value": 3.1131515214639E13
                        }
                    },
                    {
                        "key_as_string": "1575158400000",
                        "key": 1575158400000,
                        "doc_count": 1093492,
                        "1": {
                            "value": 5.98186891151516E14
                        }
                    },
                    {
                        "key_as_string": "1577836800000",
                        "key": 1577836800000,
                        "doc_count": 4237051,
                        "1": {
                            "value": 1.836570224952397E15
                        }
                    },
                    {
                        "key_as_string": "1580515200000",
                        "key": 1580515200000,
                        "doc_count": 5817013,
                        "1": {
                            "value": 2.402788471921031E15
                        }
                    },
                    {
                        "key_as_string": "1583020800000",
                        "key": 1583020800000,
                        "doc_count": 1776541,
                        "1": {
                            "value": 2.096801069488434E15
                        }
                    },
                    {
                        "key_as_string": "1585699200000",
                        "key": 1585699200000,
                        "doc_count": 1187889,
                        "1": {
                            "value": 1.997365235904066E15
                        }
                    },
                    {
                        "key_as_string": "1588291200000",
                        "key": 1588291200000,
                        "doc_count": 186710,
                        "1": {
                            "value": 6.38888983132788E14
                        }
                    }
                ]
            }
        },
        {
            "key": "University of California, San Diego",
            "doc_count": 11951390,
            "1": {
                "value": 7.4695422669491456E16
            },
            "2": {
                "buckets": [
                    {
                        "key_as_string": "1572566400000",
                        "key": 1572566400000,
                        "doc_count": 169316,
                        "1": {
                            "value": 9.384232582957E13
                        }
                    },
                    {
                        "key_as_string": "1575158400000",
                        "key": 1575158400000,
                        "doc_count": 1653127,
                        "1": {
                            "value": 8.06130026220778E14
                        }
                    },
                    {
                        "key_as_string": "1577836800000",
                        "key": 1577836800000,
                        "doc_count": 3300844,
                        "1": {
                            "value": 2.885549592452404E15
                        }
                    },
                    {
                        "key_as_string": "1580515200000",
                        "key": 1580515200000,
                        "doc_count": 2798141,
                        "1": {
                            "value": 2.396298822106766E15
                        }
                    },
                    {
                        "key_as_string": "1583020800000",
                        "key": 1583020800000,
                        "doc_count": 1712510,
                        "1": {
                            "value": 1.524144210891664E15
                        }
                    },
                    {
                        "key_as_string": "1585699200000",
                        "key": 1585699200000,
                        "doc_count": 2054241,
                        "1": {
                            "value": 1.354704494663612E15
                        }
                    },
                    {
                        "key_as_string": "1588291200000",
                        "key": 1588291200000,
                        "doc_count": 263211,
                        "1": {
                            "value": 2.76258361521639E14
                        }
                    }
                ]
            }
        },
        {
            "key": "San Diego Supercomputer Center",
            "doc_count": 7216381,
            "1": {
                "value": 6.465270101576212E16
            },
            "2": {
                "buckets": [
                    {
                        "key_as_string": "1572566400000",
                        "key": 1572566400000,
                        "doc_count": 148541,
                        "1": {
                            "value": 1.20982240035277E14
                        }
                    },
                    {
                        "key_as_string": "1575158400000",
                        "key": 1575158400000,
                        "doc_count": 1957608,
                        "1": {
                            "value": 1.446244156315223E15
                        }
                    },
                    {
                        "key_as_string": "1577836800000",
                        "key": 1577836800000,
                        "doc_count": 2473805,
                        "1": {
                            "value": 2.314955001447676E15
                        }
                    },
                    {
                        "key_as_string": "1580515200000",
                        "key": 1580515200000,
                        "doc_count": 972240,
                        "1": {
                            "value": 1.556386786518228E15
                        }
                    },
                    {
                        "key_as_string": "1583020800000",
                        "key": 1583020800000,
                        "doc_count": 622567,
                        "1": {
                            "value": 1.145852553019776E15
                        }
                    },
                    {
                        "key_as_string": "1585699200000",
                        "key": 1585699200000,
                        "doc_count": 909959,
                        "1": {
                            "value": 1.17153621034423E15
                        }
                    },
                    {
                        "key_as_string": "1588291200000",
                        "key": 1588291200000,
                        "doc_count": 131661,
                        "1": {
                            "value": 3.25630679289855E14
                        }
                    }
                ]
            }
        },
        {
            "key": "University of Texas at Austin",
            "doc_count": 8568019,
            "1": {
                "value": 6.3006026220105304E16
            },
            "2": {
                "buckets": [
                    {
                        "key_as_string": "1572566400000",
                        "key": 1572566400000,
                        "doc_count": 918985,
                        "1": {
                            "value": 4.76086284056786E14
                        }
                    },
                    {
                        "key_as_string": "1575158400000",
                        "key": 1575158400000,
                        "doc_count": 1869460,
                        "1": {
                            "value": 1.627687368308038E15
                        }
                    },
                    {
                        "key_as_string": "1577836800000",
                        "key": 1577836800000,
                        "doc_count": 547946,
                        "1": {
                            "value": 1.800015283600443E15
                        }
                    },
                    {
                        "key_as_string": "1580515200000",
                        "key": 1580515200000,
                        "doc_count": 2671987,
                        "1": {
                            "value": 1.181002112788345E15
                        }
                    },
                    {
                        "key_as_string": "1583020800000",
                        "key": 1583020800000,
                        "doc_count": 2277705,
                        "1": {
                            "value": 1.020941924444253E15
                        }
                    },
                    {
                        "key_as_string": "1585699200000",
                        "key": 1585699200000,
                        "doc_count": 256250,
                        "1": {
                            "value": 1.461521993945698E15
                        }
                    },
                    {
                        "key_as_string": "1588291200000",
                        "key": 1588291200000,
                        "doc_count": 25686,
                        "1": {
                            "value": 3.084983103696E14
                        }
                    }
                ]
            }
        },
        {
            "key": "University of Southern California",
            "doc_count": 10222362,
            "1": {
                "value": 6.2302038542399144E16
            },
            "2": {
                "buckets": [
                    {
                        "key_as_string": "1572566400000",
                        "key": 1572566400000,
                        "doc_count": 265574,
                        "1": {
                            "value": 1.94747601975808E14
                        }
                    },
                    {
                        "key_as_string": "1575158400000",
                        "key": 1575158400000,
                        "doc_count": 2242532,
                        "1": {
                            "value": 1.375991057535075E15
                        }
                    },
                    {
                        "key_as_string": "1577836800000",
                        "key": 1577836800000,
                        "doc_count": 2872713,
                        "1": {
                            "value": 2.661926868284566E15
                        }
                    },
                    {
                        "key_as_string": "1580515200000",
                        "key": 1580515200000,
                        "doc_count": 1469252,
                        "1": {
                            "value": 1.691440124240073E15
                        }
                    },
                    {
                        "key_as_string": "1583020800000",
                        "key": 1583020800000,
                        "doc_count": 1567768,
                        "1": {
                            "value": 8.61994915825587E14
                        }
                    },
                    {
                        "key_as_string": "1585699200000",
                        "key": 1585699200000,
                        "doc_count": 1505813,
                        "1": {
                            "value": 8.5625648217993E14
                        }
                    },
                    {
                        "key_as_string": "1588291200000",
                        "key": 1588291200000,
                        "doc_count": 298710,
                        "1": {
                            "value": 1.45397767758854E14
                        }
                    }
                ]
            }
        },
        {
            "key": "University of Nebraska-Lincoln",
            "doc_count": 5518105,
            "1": {
                "value": 5.9215977636653312E16
            },
            "2": {
                "buckets": [
                    {
                        "key_as_string": "1572566400000",
                        "key": 1572566400000,
                        "doc_count": 110971,
                        "1": {
                            "value": 4.9630666579456E13
                        }
                    },
                    {
                        "key_as_string": "1575158400000",
                        "key": 1575158400000,
                        "doc_count": 565781,
                        "1": {
                            "value": 4.82947306527296E14
                        }
                    },
                    {
                        "key_as_string": "1577836800000",
                        "key": 1577836800000,
                        "doc_count": 1311551,
                        "1": {
                            "value": 1.777970359401984E15
                        }
                    },
                    {
                        "key_as_string": "1580515200000",
                        "key": 1580515200000,
                        "doc_count": 1557651,
                        "1": {
                            "value": 1.567053727614037E15
                        }
                    },
                    {
                        "key_as_string": "1583020800000",
                        "key": 1583020800000,
                        "doc_count": 776341,
                        "1": {
                            "value": 1.395706133253672E15
                        }
                    },
                    {
                        "key_as_string": "1585699200000",
                        "key": 1585699200000,
                        "doc_count": 966547,
                        "1": {
                            "value": 1.602542345029731E15
                        }
                    },
                    {
                        "key_as_string": "1588291200000",
                        "key": 1588291200000,
                        "doc_count": 229263,
                        "1": {
                            "value": 5.26146666175488E14
                        }
                    }
                ]
            }
        },
        {
            "key": "University of Wisconsin Madison",
            "doc_count": 16401480,
            "1": {
                "value": 5.7198096611801776E16
            },
            "2": {
                "buckets": [
                    {
                        "key_as_string": "1572566400000",
                        "key": 1572566400000,
                        "doc_count": 289065,
                        "1": {
                            "value": 1.27365094369504E14
                        }
                    },
                    {
                        "key_as_string": "1575158400000",
                        "key": 1575158400000,
                        "doc_count": 4130395,
                        "1": {
                            "value": 1.112846107703218E15
                        }
                    },
                    {
                        "key_as_string": "1577836800000",
                        "key": 1577836800000,
                        "doc_count": 7289409,
                        "1": {
                            "value": 3.062607535634154E15
                        }
                    },
                    {
                        "key_as_string": "1580515200000",
                        "key": 1580515200000,
                        "doc_count": 1016419,
                        "1": {
                            "value": 7.99895807951353E14
                        }
                    },
                    {
                        "key_as_string": "1583020800000",
                        "key": 1583020800000,
                        "doc_count": 1428282,
                        "1": {
                            "value": 8.77001230623411E14
                        }
                    },
                    {
                        "key_as_string": "1585699200000",
                        "key": 1585699200000,
                        "doc_count": 1918644,
                        "1": {
                            "value": 9.12226685098856E14
                        }
                    },
                    {
                        "key_as_string": "1588291200000",
                        "key": 1588291200000,
                        "doc_count": 329266,
                        "1": {
                            "value": 2.57819615094726E14
                        }
                    }
                ]
            }
        },
        {
            "key": "The Regents of the University of California - University of California, San Diego.",
            "doc_count": 9035467,
            "1": {
                "value": 5.562980250916632E16
            },
            "2": {
                "buckets": [
                    {
                        "key_as_string": "1572566400000",
                        "key": 1572566400000,
                        "doc_count": 402335,
                        "1": {
                            "value": 1.59291327819704E14
                        }
                    },
                    {
                        "key_as_string": "1575158400000",
                        "key": 1575158400000,
                        "doc_count": 2418229,
                        "1": {
                            "value": 1.396062284836665E15
                        }
                    },
                    {
                        "key_as_string": "1577836800000",
                        "key": 1577836800000,
                        "doc_count": 2745073,
                        "1": {
                            "value": 2.878751941408089E15
                        }
                    },
                    {
                        "key_as_string": "1580515200000",
                        "key": 1580515200000,
                        "doc_count": 1261761,
                        "1": {
                            "value": 9.20049904270787E14
                        }
                    },
                    {
                        "key_as_string": "1583020800000",
                        "key": 1583020800000,
                        "doc_count": 1162211,
                        "1": {
                            "value": 8.35599688270799E14
                        }
                    },
                    {
                        "key_as_string": "1585699200000",
                        "key": 1585699200000,
                        "doc_count": 902933,
                        "1": {
                            "value": 5.83928207043059E14
                        }
                    },
                    {
                        "key_as_string": "1588291200000",
                        "key": 1588291200000,
                        "doc_count": 142925,
                        "1": {
                            "value": 1.80041959996687E14
                        }
                    }
                ]
            }
        },
        {
            "key": "Brookhaven National Laboratory",
            "doc_count": 6665641,
            "1": {
                "value": 5.0688431245195328E16
            },
            "2": {
                "buckets": [
                    {
                        "key_as_string": "1572566400000",
                        "key": 1572566400000,
                        "doc_count": 797114,
                        "1": {
                            "value": 5.48859113998134E14
                        }
                    },
                    {
                        "key_as_string": "1575158400000",
                        "key": 1575158400000,
                        "doc_count": 1439085,
                        "1": {
                            "value": 1.255146324106186E15
                        }
                    },
                    {
                        "key_as_string": "1577836800000",
                        "key": 1577836800000,
                        "doc_count": 1262800,
                        "1": {
                            "value": 1.264162604341937E15
                        }
                    },
                    {
                        "key_as_string": "1580515200000",
                        "key": 1580515200000,
                        "doc_count": 718034,
                        "1": {
                            "value": 8.52151605158544E14
                        }
                    },
                    {
                        "key_as_string": "1583020800000",
                        "key": 1583020800000,
                        "doc_count": 1152240,
                        "1": {
                            "value": 9.62340348654592E14
                        }
                    },
                    {
                        "key_as_string": "1585699200000",
                        "key": 1585699200000,
                        "doc_count": 1106613,
                        "1": {
                            "value": 1.297536739083975E15
                        }
                    },
                    {
                        "key_as_string": "1588291200000",
                        "key": 1588291200000,
                        "doc_count": 189755,
                        "1": {
                            "value": 1.55857170306048E14
                        }
                    }
                ]
            }
        },
        {
            "key": "Amazon.com, Inc.",
            "doc_count": 72252699,
            "1": {
                "value": 4.8451086408821E16
            },
            "2": {
                "buckets": [
                    {
                        "key_as_string": "1572566400000",
                        "key": 1572566400000,
                        "doc_count": 12586451,
                        "1": {
                            "value": 4.60297722396708E14
                        }
                    },
                    {
                        "key_as_string": "1575158400000",
                        "key": 1575158400000,
                        "doc_count": 13226206,
                        "1": {
                            "value": 1.315330647059971E15
                        }
                    },
                    {
                        "key_as_string": "1577836800000",
                        "key": 1577836800000,
                        "doc_count": 18309663,
                        "1": {
                            "value": 1.526977580125392E15
                        }
                    },
                    {
                        "key_as_string": "1580515200000",
                        "key": 1580515200000,
                        "doc_count": 13922609,
                        "1": {
                            "value": 9.02687389938451E14
                        }
                    },
                    {
                        "key_as_string": "1583020800000",
                        "key": 1583020800000,
                        "doc_count": 8124347,
                        "1": {
                            "value": 8.44983744544791E14
                        }
                    },
                    {
                        "key_as_string": "1585699200000",
                        "key": 1585699200000,
                        "doc_count": 4833081,
                        "1": {
                            "value": 7.919359454177E14
                        }
                    },
                    {
                        "key_as_string": "1588291200000",
                        "key": 1588291200000,
                        "doc_count": 1250342,
                        "1": {
                            "value": 2.14172771619612E14
                        }
                    }
                ]
            }
        }
    ]
}

let parsed_data = []

console.log(data)

// extract raw data by org
for (i in data.buckets) {
    org = data.buckets[i].key;
    parsed_data[i] = { "org": org, "data": [] };
    let inner_buckets = data.buckets[i][2].buckets;
    for (j in inner_buckets) {
        date = inner_buckets[j].key;
        value = inner_buckets[j][1].value;
        parsed_data[i].data[j] = { "date": date, "value": value, "rank": 0, "orig_index": parseInt(i) }
    }
}

console.log(parsed_data)

// assign ranks to data
for (i in parsed_data[0].data) {
    let temp_array = []
    for (j in parsed_data) {
        temp_array[j] = parsed_data[j].data[i]
    }
    temp_array.sort((a, b) => { return b.value - a.value })
    console.log(temp_array)
    for (let k = 0; k < temp_array.length; k++) {
        parsed_data[temp_array[k].orig_index].data[i].rank = k
    }
}
console.log("new data")
console.log(parsed_data)

let colorPal = ["rgba(223, 79, 79, 0.5)",
    "rgba(88, 223, 79, 0.5)",
    "rgba(79, 145, 223, 0.5)",
    "rgba(223, 79, 168, 0.5)",
    "rgba(223, 155, 79, 0.5)",
    "rgba(79, 223, 192, 0.5)",
    "rgba(138, 79, 223, 0.5)",
    "rgba(166, 223, 79, 0.5)",
    "rgba(147, 50, 55, 0.5)",
    "rgba(50, 147, 142, 0.5)",
    "rgba(59, 147, 50, 0.5)",
    "rgba(94, 50, 147, 0.5)",
    "rgba(147, 78, 50, 0.5)",
    "rgba(50, 81, 147, 0.5)"]

// add color and org to data points

for (i in parsed_data) {
    for (j in parsed_data[i].data) {
        parsed_data[i].data[j].org = parsed_data[i].org
        parsed_data[i].data[j].color = colorPal[i % colorPal.length]
    }
    
}

// Starting pos = parsed_data[i].org
// Find final positions
let final_positions = [];
for (i in parsed_data) {
    let last = parsed_data[i].data[parsed_data[i].data.length - 1];
    final_positions[i] = {
        org: last.org,
        rank: last.rank
    }
}
final_positions.sort((a, b) => { return a.rank - b.rank })

// parser needs to return: final_positions, 


/////////////////////////////////////Make the Viz/////////////////////////////////////////////////////////////

// set the dimensions and margins of the graph
var margin = { top: 25, right: 250, bottom: 75, left: 50, spacer: 25 },
    width = 1300 - margin.left - margin.right,
    height = 500 - margin.top - margin.bottom;

// append the svg object to the body of the page
var svg = d3.select("#chart-area")
    .append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom + margin.spacer)
    .append("g")
    .attr("height", height)
    .attr("transform",
        "translate(" + margin.left + "," + margin.top + ")");

// function to wrap text!
function wrap(text, width) {
    text.each(function () {
        var text = d3.select(this),
            words = text.text().split(/\s+/).reverse(),
            word,
            line = [],
            lineNumber = 0,
            lineHeight = 1.1, // ems
            y = text.attr("y"),
            dy = parseFloat(text.attr("dy")),
            tspan = text.text(null).append("tspan").attr("x", 0).attr("y", y).attr("dy", dy + "em");
        while (word = words.pop()) {
            line.push(word);
            tspan.text(line.join(" "));
            if (tspan.node().getComputedTextLength() > width) {
                line.pop();
                tspan.text(line.join(" "));
                line = [word];
                tspan = text.append("tspan").attr("x", 0).attr("y", y).attr("dy", ++lineNumber * lineHeight + dy + "em").text(word);
            }
        }
    });
}

// the date range of available data:
var dataXrange = d3.extent(parsed_data[0].data, function (d) { return d.date; });
var dataYrange = [0, 9];

// maximum date range allowed to display
var mindate = dataXrange[0],  // use the range of the data
    maxdate = dataXrange[1];

// timestamp formatter

var dateFormat = d3.timeFormat("%m/%d/%y");


// Add X scale
var x = d3.scaleTime()
    .domain(dataXrange)
    .range([0, width])


// Add Y scale
var y = d3.scaleLinear()
    .domain(dataYrange)
    .range([0, height])



// Add axes
var rightAxis = d3.axisRight(y)
    .tickSize(5)
    .tickFormat((d) => {
        return final_positions[d].org
    })

var bottomAxis = d3.axisBottom(x)
    .tickSize(5)
    .tickFormat(dateFormat)

// var leftAxis = d3.axisLeft(y)
//     .tickSize(5)
//     .tickFormat((d) => {
//         return parsed_data[d].org
//     })

svg.append("g").call(rightAxis)
    .attr("margin", 10)
    .attr("transform", "translate(" + width + "," + margin.top + ")")
    .selectAll(".tick text")
    .call(wrap, margin.right - 25)
    .attr("transform", "translate(" + 10 + ",0)")

svg.append("g")
    .call(bottomAxis)
    .attr("class", "axis")
    .attr("transform", "translate(0," + (height + margin.spacer + margin.top) + ")")
    .selectAll(".tick text")
    .call(wrap, 100)
    .attr("transform", "rotate(-60)")
    .style("text-anchor", "end")


// // width scale
// var w = d3.scaleLinear()
//     .domain([top_10_pairs[top_10_pairs.length - 1][2], top_10_pairs[0][2]])
//     .range([1, 10])

// Add axis labels... replace with variable after in Grafana
svg.append("text")
    .attr("class", "header-text")
    .attr("transform",
        "translate(" + (width + margin.left) + " ," +
        (margin.top /4) + ")")
    .style("text-anchor", "start")
    .text("Source Organization");


// For lines tooltip
var div = d3.select("body").append("div")
    .attr("class", "tooltip")
    .style("opacity", 0);

// Add the lines
for (i in parsed_data) {
    svg.append("svg")
        .attr("width", width)
        .attr("height", height + margin.spacer + margin.top)
        .append("g")
        .attr("transform", "translate(0," + margin.top + ")")
        .append("path")
        .attr("class", "org-" + i)
        .datum(parsed_data[i].data)
        .attr("fill", "none")
        .attr("stroke", colorPal[i % colorPal.length])
        .attr("stroke-width", 7)
        .attr("d", d3.line().curve(d3.curveMonotoneX)
            .x(function (d) { return x(d.date) })
            .y(function (d) { return y(d.rank) }))
        // Add Tootip and hover settings
        .on("mouseover", function (d) {
            d3.select(this).attr("stroke", () => {
                var hover_color = d[0].color;
                var index = hover_color.lastIndexOf(",");
                hover_color = hover_color.substring(0, index) + ", 1.0)"
                console.log("hover color: " + hover_color);
                return hover_color;
            })
            div.transition()
                .duration(200)
                .style("opacity", .9);
            div.html(() => {
                var text = "<b>" + d[0].org + "</b>";
                return text;
            })
                .style("left", (d3.event.pageX) + "px")
                .style("top", (d3.event.pageY - 28) + "px")
        })
        .on("mouseout", function (d) {
            div.transition()
                .duration(500)
                .style("opacity", 0);
            d3.select(this).attr("stroke", () => {
                return d[0].color;
            })
        })
    ///////////////////////
    // Add Nodes
    var node = svg.append("svg")
        .attr("width", width + 10)
        .attr("height", height + margin.spacer + margin.top)
        .append("g")
        .attr("transform", "translate(0," + margin.top + ")")
        .selectAll("circle")
        .data(parsed_data[i].data)
        .enter().append("circle")
        .attr("class", "org-" + i)
        .attr("cx", function (d) { return x(d.date); })
        .attr("cy", function (d) { return y(d.rank); })
        .attr('fill', colorPal[i % colorPal.length])
        .attr("r", 10)
        .attr('stroke', colorPal[i % colorPal.length])
        .attr("stroke-width", 1.5)
}



///////////////////////
// point Tooltips
var tooltip = d3.select("body").append("div")
    .attr("class", "small-tooltip");

svg.selectAll("circle")
    .on("mouseover", function (d) {
        // Darken circle
        d3.select(this).attr("fill", () => {
            var hover_color = d.color;
            var index = hover_color.lastIndexOf(",");
            hover_color = hover_color.substring(0, index) + ", 1.0)"
            return hover_color;
        })
        // Darken Line
        d3.selectAll('.org-' + d.orig_index).attr("stroke", () => {
            var hover_color = d.color;
            var index = hover_color.lastIndexOf(",");
            hover_color = hover_color.substring(0, index) + ", 1.0)"
            return hover_color;
        })
        div.transition()
            .duration(200)
            .style("opacity", .9);
        div.html(() => {
            var rank = d.rank + 1
            var text = "<b>" + rank + ": </b>" + d.org;
            return text;
        })
            .style("left", (d3.event.pageX) + "px")
            .style("top", (d3.event.pageY - 28) + "px")
    })
    .on("mouseout", function (d) {
        div.transition()
            .duration(500)
            .style("opacity", 0);
        d3.select(this).attr("fill", () => {
            return d.color;
        })
        d3.selectAll('.org-' + d.orig_index).attr("stroke", () => {
                return d.color;
        })
    })

//        var tooltip_str = "Club: " + d['club'] +
//             "<br/>" + "Year: " + d['year'] +
//             "<br/>" + "Points: " + d['points'] +
//             "<br/>" + "W/L/T: " + d['wins'] + " / " + d['losses'] + " / " + d['ties'] +
//             "<br/>" + "Goals F/A: " + d['goals_for'] + " / " + d['goals_against'];

//         if (d['alias'] != '') {
//             tooltip_str += "<br/>(aka: " + d['alias'] + ")";
//         }

//         tooltip.html(tooltip_str)
//             .style("visibility", "visible");
//     .on("mousemove", function (d) {
//         tooltip.style("top", event.pageY - (tooltip.node().clientHeight + 5) + "px")
//             .style("left", event.pageX - (tooltip.node().clientWidth / 2.0) + "px");
//     })
//     .on("mouseout", function (d) {
//         chart.selectAll('.' + d['class'])
//             .classed('active', false);

//         tooltip.style("visibility", "hidden");
//     })
//     .on('click', function (d) {
//         chart.selectAll('.' + d['class'])
//             .classed('click-active', function (d) {
//                 // toggle state
//                 return !d3.select(this).classed('click-active');
//             });
//     })

