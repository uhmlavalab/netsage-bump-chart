data = {
    "buckets": [
        {
            "key": "Fermi National Accelerator Laboratory (Fermilab)",
            "doc_count": 35439946,
            "1": {
                "value": 1.0492430152115912E17
            },
            "2": {
                "buckets": [
                    {
                        "key_as_string": "1574294400000",
                        "key": 1574294400000,
                        "doc_count": 1401394,
                        "1": {
                            "value": 5.14385417402653E14
                        }
                    },
                    {
                        "key_as_string": "1574899200000",
                        "key": 1574899200000,
                        "doc_count": 4248544,
                        "1": {
                            "value": 1.334531824116585E15
                        }
                    },
                    {
                        "key_as_string": "1575504000000",
                        "key": 1575504000000,
                        "doc_count": 3633857,
                        "1": {
                            "value": 1.11575897614762E15
                        }
                    },
                    {
                        "key_as_string": "1576108800000",
                        "key": 1576108800000,
                        "doc_count": 4608717,
                        "1": {
                            "value": 1.701091709928537E15
                        }
                    },
                    {
                        "key_as_string": "1576713600000",
                        "key": 1576713600000,
                        "doc_count": 5447916,
                        "1": {
                            "value": 1.990628286213938E15
                        }
                    },
                    {
                        "key_as_string": "1577318400000",
                        "key": 1577318400000,
                        "doc_count": 5285796,
                        "1": {
                            "value": 2.003190580475793E15
                        }
                    },
                    {
                        "key_as_string": "1577923200000",
                        "key": 1577923200000,
                        "doc_count": 3780739,
                        "1": {
                            "value": 1.288593338520031E15
                        }
                    },
                    {
                        "key_as_string": "1578528000000",
                        "key": 1578528000000,
                        "doc_count": 4187493,
                        "1": {
                            "value": 1.733300523733408E15
                        }
                    },
                    {
                        "key_as_string": "1579132800000",
                        "key": 1579132800000,
                        "doc_count": 2845490,
                        "1": {
                            "value": 1.434057033606325E15
                        }
                    }
                ]
            }
        },
        {
            "key": "UltraLight",
            "doc_count": 19719679,
            "1": {
                "value": 1.04504600198859568E17
            },
            "2": {
                "buckets": [
                    {
                        "key_as_string": "1574294400000",
                        "key": 1574294400000,
                        "doc_count": 571426,
                        "1": {
                            "value": 8.020067556352E14
                        }
                    },
                    {
                        "key_as_string": "1574899200000",
                        "key": 1574899200000,
                        "doc_count": 6206047,
                        "1": {
                            "value": 2.086371932278784E15
                        }
                    },
                    {
                        "key_as_string": "1575504000000",
                        "key": 1575504000000,
                        "doc_count": 3157051,
                        "1": {
                            "value": 1.413336092814848E15
                        }
                    },
                    {
                        "key_as_string": "1576108800000",
                        "key": 1576108800000,
                        "doc_count": 2783158,
                        "1": {
                            "value": 2.434393181123072E15
                        }
                    },
                    {
                        "key_as_string": "1576713600000",
                        "key": 1576713600000,
                        "doc_count": 1643418,
                        "1": {
                            "value": 1.695324672471552E15
                        }
                    },
                    {
                        "key_as_string": "1577318400000",
                        "key": 1577318400000,
                        "doc_count": 1037379,
                        "1": {
                            "value": 1.116952762262016E15
                        }
                    },
                    {
                        "key_as_string": "1577923200000",
                        "key": 1577923200000,
                        "doc_count": 1549592,
                        "1": {
                            "value": 1.403277075802624E15
                        }
                    },
                    {
                        "key_as_string": "1578528000000",
                        "key": 1578528000000,
                        "doc_count": 1970499,
                        "1": {
                            "value": 1.31995739910144E15
                        }
                    },
                    {
                        "key_as_string": "1579132800000",
                        "key": 1579132800000,
                        "doc_count": 801109,
                        "1": {
                            "value": 7.9145515336791E14
                        }
                    }
                ]
            }
        },
        {
            "key": "University Corporation for Atmospheric Research",
            "doc_count": 16811752,
            "1": {
                "value": 9.6126410350491552E16
            },
            "2": {
                "buckets": [
                    {
                        "key_as_string": "1574294400000",
                        "key": 1574294400000,
                        "doc_count": 737753,
                        "1": {
                            "value": 6.03168603275339E14
                        }
                    },
                    {
                        "key_as_string": "1574899200000",
                        "key": 1574899200000,
                        "doc_count": 1973024,
                        "1": {
                            "value": 1.593981164838964E15
                        }
                    },
                    {
                        "key_as_string": "1575504000000",
                        "key": 1575504000000,
                        "doc_count": 2198419,
                        "1": {
                            "value": 1.559468567010462E15
                        }
                    },
                    {
                        "key_as_string": "1576108800000",
                        "key": 1576108800000,
                        "doc_count": 2084411,
                        "1": {
                            "value": 1.565292612377974E15
                        }
                    },
                    {
                        "key_as_string": "1576713600000",
                        "key": 1576713600000,
                        "doc_count": 2000572,
                        "1": {
                            "value": 1.40629476638648E15
                        }
                    },
                    {
                        "key_as_string": "1577318400000",
                        "key": 1577318400000,
                        "doc_count": 1565178,
                        "1": {
                            "value": 1.09724987112164E15
                        }
                    },
                    {
                        "key_as_string": "1577923200000",
                        "key": 1577923200000,
                        "doc_count": 1685577,
                        "1": {
                            "value": 1.19633173211993E15
                        }
                    },
                    {
                        "key_as_string": "1578528000000",
                        "key": 1578528000000,
                        "doc_count": 2446312,
                        "1": {
                            "value": 1.555741022958541E15
                        }
                    },
                    {
                        "key_as_string": "1579132800000",
                        "key": 1579132800000,
                        "doc_count": 2120506,
                        "1": {
                            "value": 1.438272953722114E15
                        }
                    }
                ]
            }
        },
        {
            "key": "NIST/U.S. Dept. of Commerce",
            "doc_count": 24803932,
            "1": {
                "value": 5.0667279826155992E16
            },
            "2": {
                "buckets": [
                    {
                        "key_as_string": "1574294400000",
                        "key": 1574294400000,
                        "doc_count": 1504664,
                        "1": {
                            "value": 3.39139480441061E14
                        }
                    },
                    {
                        "key_as_string": "1574899200000",
                        "key": 1574899200000,
                        "doc_count": 3298001,
                        "1": {
                            "value": 8.52033210696223E14
                        }
                    },
                    {
                        "key_as_string": "1575504000000",
                        "key": 1575504000000,
                        "doc_count": 3110129,
                        "1": {
                            "value": 7.97636145823966E14
                        }
                    },
                    {
                        "key_as_string": "1576108800000",
                        "key": 1576108800000,
                        "doc_count": 2991632,
                        "1": {
                            "value": 7.39172417039065E14
                        }
                    },
                    {
                        "key_as_string": "1576713600000",
                        "key": 1576713600000,
                        "doc_count": 3102105,
                        "1": {
                            "value": 8.41386915103995E14
                        }
                    },
                    {
                        "key_as_string": "1577318400000",
                        "key": 1577318400000,
                        "doc_count": 2680319,
                        "1": {
                            "value": 7.09292617700532E14
                        }
                    },
                    {
                        "key_as_string": "1577923200000",
                        "key": 1577923200000,
                        "doc_count": 3465663,
                        "1": {
                            "value": 8.15851876136543E14
                        }
                    },
                    {
                        "key_as_string": "1578528000000",
                        "key": 1578528000000,
                        "doc_count": 2904353,
                        "1": {
                            "value": 7.09445141685343E14
                        }
                    },
                    {
                        "key_as_string": "1579132800000",
                        "key": 1579132800000,
                        "doc_count": 1747066,
                        "1": {
                            "value": 5.29452173642771E14
                        }
                    }
                ]
            }
        },
        {
            "key": "FUNDAÇÃO DE AMPARO À PESQUISA DO ESTADO SÃO PAULO",
            "doc_count": 21766862,
            "1": {
                "value": 4.1055482673680384E16
            },
            "2": {
                "buckets": [
                    {
                        "key_as_string": "1574294400000",
                        "key": 1574294400000,
                        "doc_count": 1898952,
                        "1": {
                            "value": 5.08378551104E14
                        }
                    },
                    {
                        "key_as_string": "1574899200000",
                        "key": 1574899200000,
                        "doc_count": 3148579,
                        "1": {
                            "value": 6.19842226609664E14
                        }
                    },
                    {
                        "key_as_string": "1575504000000",
                        "key": 1575504000000,
                        "doc_count": 2864006,
                        "1": {
                            "value": 6.10450838813696E14
                        }
                    },
                    {
                        "key_as_string": "1576108800000",
                        "key": 1576108800000,
                        "doc_count": 1526435,
                        "1": {
                            "value": 2.9033043269632E14
                        }
                    },
                    {
                        "key_as_string": "1576713600000",
                        "key": 1576713600000,
                        "doc_count": 2202303,
                        "1": {
                            "value": 5.89988905094144E14
                        }
                    },
                    {
                        "key_as_string": "1577318400000",
                        "key": 1577318400000,
                        "doc_count": 750059,
                        "1": {
                            "value": 1.78634757056512E14
                        }
                    },
                    {
                        "key_as_string": "1577923200000",
                        "key": 1577923200000,
                        "doc_count": 590715,
                        "1": {
                            "value": 8.5339718812672E13
                        }
                    },
                    {
                        "key_as_string": "1578528000000",
                        "key": 1578528000000,
                        "doc_count": 5092180,
                        "1": {
                            "value": 1.154154542596608E15
                        }
                    },
                    {
                        "key_as_string": "1579132800000",
                        "key": 1579132800000,
                        "doc_count": 3693633,
                        "1": {
                            "value": 1.094815361426432E15
                        }
                    }
                ]
            }
        },
        {
            "key": "Jisc Services Limited",
            "doc_count": 8049799,
            "1": {
                "value": 3.808348769573316E16
            },
            "2": {
                "buckets": [
                    {
                        "key_as_string": "1574294400000",
                        "key": 1574294400000,
                        "doc_count": 517268,
                        "1": {
                            "value": 2.37641715563835E14
                        }
                    },
                    {
                        "key_as_string": "1574899200000",
                        "key": 1574899200000,
                        "doc_count": 782040,
                        "1": {
                            "value": 5.08602978239037E14
                        }
                    },
                    {
                        "key_as_string": "1575504000000",
                        "key": 1575504000000,
                        "doc_count": 937382,
                        "1": {
                            "value": 8.49923208699061E14
                        }
                    },
                    {
                        "key_as_string": "1576108800000",
                        "key": 1576108800000,
                        "doc_count": 814668,
                        "1": {
                            "value": 4.548673428017E14
                        }
                    },
                    {
                        "key_as_string": "1576713600000",
                        "key": 1576713600000,
                        "doc_count": 1005452,
                        "1": {
                            "value": 5.20064025631934E14
                        }
                    },
                    {
                        "key_as_string": "1577318400000",
                        "key": 1577318400000,
                        "doc_count": 923072,
                        "1": {
                            "value": 5.44591874029006E14
                        }
                    },
                    {
                        "key_as_string": "1577923200000",
                        "key": 1577923200000,
                        "doc_count": 1118846,
                        "1": {
                            "value": 5.71032676125925E14
                        }
                    },
                    {
                        "key_as_string": "1578528000000",
                        "key": 1578528000000,
                        "doc_count": 1031081,
                        "1": {
                            "value": 4.75773996122595E14
                        }
                    },
                    {
                        "key_as_string": "1579132800000",
                        "key": 1579132800000,
                        "doc_count": 919990,
                        "1": {
                            "value": 5.97938144753552E14
                        }
                    }
                ]
            }
        },
        {
            "key": "Stanford University",
            "doc_count": 8074020,
            "1": {
                "value": 3.6264806283999024E16
            },
            "2": {
                "buckets": [
                    {
                        "key_as_string": "1574294400000",
                        "key": 1574294400000,
                        "doc_count": 196175,
                        "1": {
                            "value": 1.02330731621051E14
                        }
                    },
                    {
                        "key_as_string": "1574899200000",
                        "key": 1574899200000,
                        "doc_count": 617646,
                        "1": {
                            "value": 3.37576901210304E14
                        }
                    },
                    {
                        "key_as_string": "1575504000000",
                        "key": 1575504000000,
                        "doc_count": 1091752,
                        "1": {
                            "value": 6.30817866999284E14
                        }
                    },
                    {
                        "key_as_string": "1576108800000",
                        "key": 1576108800000,
                        "doc_count": 1128556,
                        "1": {
                            "value": 6.62240165639809E14
                        }
                    },
                    {
                        "key_as_string": "1576713600000",
                        "key": 1576713600000,
                        "doc_count": 1161345,
                        "1": {
                            "value": 6.80579373379029E14
                        }
                    },
                    {
                        "key_as_string": "1577318400000",
                        "key": 1577318400000,
                        "doc_count": 745637,
                        "1": {
                            "value": 3.57751512316936E14
                        }
                    },
                    {
                        "key_as_string": "1577923200000",
                        "key": 1577923200000,
                        "doc_count": 920095,
                        "1": {
                            "value": 5.47035229148405E14
                        }
                    },
                    {
                        "key_as_string": "1578528000000",
                        "key": 1578528000000,
                        "doc_count": 1253490,
                        "1": {
                            "value": 6.74589926006197E14
                        }
                    },
                    {
                        "key_as_string": "1579132800000",
                        "key": 1579132800000,
                        "doc_count": 959324,
                        "1": {
                            "value": 5.40179079178863E14
                        }
                    }
                ]
            }
        },
        {
            "key": "European Organization for Nuclear Research",
            "doc_count": 10556837,
            "1": {
                "value": 3.5513596139187568E16
            },
            "2": {
                "buckets": [
                    {
                        "key_as_string": "1574294400000",
                        "key": 1574294400000,
                        "doc_count": 642437,
                        "1": {
                            "value": 1.80951910974976E14
                        }
                    },
                    {
                        "key_as_string": "1574899200000",
                        "key": 1574899200000,
                        "doc_count": 1402599,
                        "1": {
                            "value": 3.82664888929198E14
                        }
                    },
                    {
                        "key_as_string": "1575504000000",
                        "key": 1575504000000,
                        "doc_count": 742136,
                        "1": {
                            "value": 3.1243587106816E14
                        }
                    },
                    {
                        "key_as_string": "1576108800000",
                        "key": 1576108800000,
                        "doc_count": 1082748,
                        "1": {
                            "value": 5.43193561737728E14
                        }
                    },
                    {
                        "key_as_string": "1576713600000",
                        "key": 1576713600000,
                        "doc_count": 1171538,
                        "1": {
                            "value": 5.1681141990912E14
                        }
                    },
                    {
                        "key_as_string": "1577318400000",
                        "key": 1577318400000,
                        "doc_count": 791498,
                        "1": {
                            "value": 3.43532841394688E14
                        }
                    },
                    {
                        "key_as_string": "1577923200000",
                        "key": 1577923200000,
                        "doc_count": 1418487,
                        "1": {
                            "value": 8.14835774208E14
                        }
                    },
                    {
                        "key_as_string": "1578528000000",
                        "key": 1578528000000,
                        "doc_count": 1559328,
                        "1": {
                            "value": 6.44955923632128E14
                        }
                    },
                    {
                        "key_as_string": "1579132800000",
                        "key": 1579132800000,
                        "doc_count": 1746066,
                        "1": {
                            "value": 6.99817325544448E14
                        }
                    }
                ]
            }
        },
        {
            "key": "National Energy Research Scientific Computing Center",
            "doc_count": 1108672,
            "1": {
                "value": 3.1906927133443432E16
            },
            "2": {
                "buckets": [
                    {
                        "key_as_string": "1574294400000",
                        "key": 1574294400000,
                        "doc_count": 51793,
                        "1": {
                            "value": 1.36972782775344E14
                        }
                    },
                    {
                        "key_as_string": "1574899200000",
                        "key": 1574899200000,
                        "doc_count": 107570,
                        "1": {
                            "value": 1.88923695476092E14
                        }
                    },
                    {
                        "key_as_string": "1575504000000",
                        "key": 1575504000000,
                        "doc_count": 163866,
                        "1": {
                            "value": 2.97501679300046E14
                        }
                    },
                    {
                        "key_as_string": "1576108800000",
                        "key": 1576108800000,
                        "doc_count": 149706,
                        "1": {
                            "value": 3.39277411499571E14
                        }
                    },
                    {
                        "key_as_string": "1576713600000",
                        "key": 1576713600000,
                        "doc_count": 155837,
                        "1": {
                            "value": 4.08241049551158E14
                        }
                    },
                    {
                        "key_as_string": "1577318400000",
                        "key": 1577318400000,
                        "doc_count": 112029,
                        "1": {
                            "value": 2.81346314718688E14
                        }
                    },
                    {
                        "key_as_string": "1577923200000",
                        "key": 1577923200000,
                        "doc_count": 111165,
                        "1": {
                            "value": 1.434827881884013E15
                        }
                    },
                    {
                        "key_as_string": "1578528000000",
                        "key": 1578528000000,
                        "doc_count": 169694,
                        "1": {
                            "value": 6.25027097783207E14
                        }
                    },
                    {
                        "key_as_string": "1579132800000",
                        "key": 1579132800000,
                        "doc_count": 87012,
                        "1": {
                            "value": 2.7624797869231E14
                        }
                    }
                ]
            }
        },
        {
            "key": "California State University, Office of the Chancellor",
            "doc_count": 7366337,
            "1": {
                "value": 2.5909499639214032E16
            },
            "2": {
                "buckets": [
                    {
                        "key_as_string": "1574294400000",
                        "key": 1574294400000,
                        "doc_count": 290135,
                        "1": {
                            "value": 1.01243365017469E14
                        }
                    },
                    {
                        "key_as_string": "1574899200000",
                        "key": 1574899200000,
                        "doc_count": 975179,
                        "1": {
                            "value": 3.44304476200205E14
                        }
                    },
                    {
                        "key_as_string": "1575504000000",
                        "key": 1575504000000,
                        "doc_count": 1608017,
                        "1": {
                            "value": 6.68232697604143E14
                        }
                    },
                    {
                        "key_as_string": "1576108800000",
                        "key": 1576108800000,
                        "doc_count": 1024708,
                        "1": {
                            "value": 4.2983326441723E14
                        }
                    },
                    {
                        "key_as_string": "1576713600000",
                        "key": 1576713600000,
                        "doc_count": 662396,
                        "1": {
                            "value": 3.94247227567483E14
                        }
                    },
                    {
                        "key_as_string": "1577318400000",
                        "key": 1577318400000,
                        "doc_count": 408262,
                        "1": {
                            "value": 2.4540490028581E14
                        }
                    },
                    {
                        "key_as_string": "1577923200000",
                        "key": 1577923200000,
                        "doc_count": 689659,
                        "1": {
                            "value": 3.75673902394545E14
                        }
                    },
                    {
                        "key_as_string": "1578528000000",
                        "key": 1578528000000,
                        "doc_count": 833998,
                        "1": {
                            "value": 3.5244436411331E14
                        }
                    },
                    {
                        "key_as_string": "1579132800000",
                        "key": 1579132800000,
                        "doc_count": 873983,
                        "1": {
                            "value": 3.27303257301559E14
                        }
                    }
                ]
            }
        },
        {
            "key": "The Regents of the University of California - University of California, San Diego.",
            "doc_count": 4709028,
            "1": {
                "value": 2.4920045176538528E16
            },
            "2": {
                "buckets": [
                    {
                        "key_as_string": "1574294400000",
                        "key": 1574294400000,
                        "doc_count": 196716,
                        "1": {
                            "value": 6.4170222365288E13
                        }
                    },
                    {
                        "key_as_string": "1574899200000",
                        "key": 1574899200000,
                        "doc_count": 437225,
                        "1": {
                            "value": 3.00231355844457E14
                        }
                    },
                    {
                        "key_as_string": "1575504000000",
                        "key": 1575504000000,
                        "doc_count": 316217,
                        "1": {
                            "value": 1.52630072559107E14
                        }
                    },
                    {
                        "key_as_string": "1576108800000",
                        "key": 1576108800000,
                        "doc_count": 725972,
                        "1": {
                            "value": 4.43877986230512E14
                        }
                    },
                    {
                        "key_as_string": "1576713600000",
                        "key": 1576713600000,
                        "doc_count": 857233,
                        "1": {
                            "value": 3.99922513766755E14
                        }
                    },
                    {
                        "key_as_string": "1577318400000",
                        "key": 1577318400000,
                        "doc_count": 308478,
                        "1": {
                            "value": 2.18604763433482E14
                        }
                    },
                    {
                        "key_as_string": "1577923200000",
                        "key": 1577923200000,
                        "doc_count": 440154,
                        "1": {
                            "value": 3.37216067947399E14
                        }
                    },
                    {
                        "key_as_string": "1578528000000",
                        "key": 1578528000000,
                        "doc_count": 509701,
                        "1": {
                            "value": 6.98764870368636E14
                        }
                    },
                    {
                        "key_as_string": "1579132800000",
                        "key": 1579132800000,
                        "doc_count": 917332,
                        "1": {
                            "value": 4.9958779455168E14
                        }
                    }
                ]
            }
        },
        {
            "key": "University of Texas at Austin",
            "doc_count": 2580978,
            "1": {
                "value": 2.3920742491679944E16
            },
            "2": {
                "buckets": [
                    {
                        "key_as_string": "1574294400000",
                        "key": 1574294400000,
                        "doc_count": 323117,
                        "1": {
                            "value": 1.35216090587597E14
                        }
                    },
                    {
                        "key_as_string": "1574899200000",
                        "key": 1574899200000,
                        "doc_count": 61025,
                        "1": {
                            "value": 2.56492561172594E14
                        }
                    },
                    {
                        "key_as_string": "1575504000000",
                        "key": 1575504000000,
                        "doc_count": 63521,
                        "1": {
                            "value": 3.08533304131965E14
                        }
                    },
                    {
                        "key_as_string": "1576108800000",
                        "key": 1576108800000,
                        "doc_count": 81530,
                        "1": {
                            "value": 2.3886731236329E14
                        }
                    },
                    {
                        "key_as_string": "1576713600000",
                        "key": 1576713600000,
                        "doc_count": 1631340,
                        "1": {
                            "value": 7.45218202110448E14
                        }
                    },
                    {
                        "key_as_string": "1577318400000",
                        "key": 1577318400000,
                        "doc_count": 56018,
                        "1": {
                            "value": 1.49610177388838E14
                        }
                    },
                    {
                        "key_as_string": "1577923200000",
                        "key": 1577923200000,
                        "doc_count": 43573,
                        "1": {
                            "value": 7.3393978857378E13
                        }
                    },
                    {
                        "key_as_string": "1578528000000",
                        "key": 1578528000000,
                        "doc_count": 152330,
                        "1": {
                            "value": 4.89323609322084E14
                        }
                    },
                    {
                        "key_as_string": "1579132800000",
                        "key": 1579132800000,
                        "doc_count": 168524,
                        "1": {
                            "value": 5.93437575525799E14
                        }
                    }
                ]
            }
        },
        {
            "key": "University of Wisconsin Madison",
            "doc_count": 9202708,
            "1": {
                "value": 2.3420934833533152E16
            },
            "2": {
                "buckets": [
                    {
                        "key_as_string": "1574294400000",
                        "key": 1574294400000,
                        "doc_count": 58565,
                        "1": {
                            "value": 2.5378557498224E13
                        }
                    },
                    {
                        "key_as_string": "1574899200000",
                        "key": 1574899200000,
                        "doc_count": 352802,
                        "1": {
                            "value": 1.37463586056831E14
                        }
                    },
                    {
                        "key_as_string": "1575504000000",
                        "key": 1575504000000,
                        "doc_count": 495282,
                        "1": {
                            "value": 1.95168492648431E14
                        }
                    },
                    {
                        "key_as_string": "1576108800000",
                        "key": 1576108800000,
                        "doc_count": 450055,
                        "1": {
                            "value": 2.08497524178959E14
                        }
                    },
                    {
                        "key_as_string": "1576713600000",
                        "key": 1576713600000,
                        "doc_count": 1046154,
                        "1": {
                            "value": 2.36700316183108E14
                        }
                    },
                    {
                        "key_as_string": "1577318400000",
                        "key": 1577318400000,
                        "doc_count": 2512330,
                        "1": {
                            "value": 5.08357638314873E14
                        }
                    },
                    {
                        "key_as_string": "1577923200000",
                        "key": 1577923200000,
                        "doc_count": 1832609,
                        "1": {
                            "value": 5.22810360769555E14
                        }
                    },
                    {
                        "key_as_string": "1578528000000",
                        "key": 1578528000000,
                        "doc_count": 1176627,
                        "1": {
                            "value": 5.13604717846994E14
                        }
                    },
                    {
                        "key_as_string": "1579132800000",
                        "key": 1579132800000,
                        "doc_count": 1278284,
                        "1": {
                            "value": 5.79635660694669E14
                        }
                    }
                ]
            }
        },
        {
            "key": "Consortium GARR",
            "doc_count": 3214783,
            "1": {
                "value": 2.2572415818207752E16
            },
            "2": {
                "buckets": [
                    {
                        "key_as_string": "1574294400000",
                        "key": 1574294400000,
                        "doc_count": 328379,
                        "1": {
                            "value": 3.00581117409183E14
                        }
                    },
                    {
                        "key_as_string": "1574899200000",
                        "key": 1574899200000,
                        "doc_count": 588500,
                        "1": {
                            "value": 4.08639571884224E14
                        }
                    },
                    {
                        "key_as_string": "1575504000000",
                        "key": 1575504000000,
                        "doc_count": 241490,
                        "1": {
                            "value": 1.66461263007045E14
                        }
                    },
                    {
                        "key_as_string": "1576108800000",
                        "key": 1576108800000,
                        "doc_count": 1338339,
                        "1": {
                            "value": 4.05370744777565E14
                        }
                    },
                    {
                        "key_as_string": "1576713600000",
                        "key": 1576713600000,
                        "doc_count": 364103,
                        "1": {
                            "value": 7.3118586207695E14
                        }
                    },
                    {
                        "key_as_string": "1577318400000",
                        "key": 1577318400000,
                        "doc_count": 112964,
                        "1": {
                            "value": 1.40443398362468E14
                        }
                    },
                    {
                        "key_as_string": "1577923200000",
                        "key": 1577923200000,
                        "doc_count": 89043,
                        "1": {
                            "value": 1.0862663366087E14
                        }
                    },
                    {
                        "key_as_string": "1578528000000",
                        "key": 1578528000000,
                        "doc_count": 0,
                        "1": {
                            "value": 0
                        }
                    },
                    {
                        "key_as_string": "1579132800000",
                        "key": 1579132800000,
                        "doc_count": 151965,
                        "1": {
                            "value": 5.60243386097664E14
                        }
                    }
                ]
            }
        },
        {
            "key": "University of Southern California",
            "doc_count": 4028854,
            "1": {
                "value": 2.1327949911214024E16
            },
            "2": {
                "buckets": [
                    {
                        "key_as_string": "1574294400000",
                        "key": 1574294400000,
                        "doc_count": 144725,
                        "1": {
                            "value": 9.9522610077184E13
                        }
                    },
                    {
                        "key_as_string": "1574899200000",
                        "key": 1574899200000,
                        "doc_count": 529226,
                        "1": {
                            "value": 2.95585166592317E14
                        }
                    },
                    {
                        "key_as_string": "1575504000000",
                        "key": 1575504000000,
                        "doc_count": 469182,
                        "1": {
                            "value": 3.20389463414269E14
                        }
                    },
                    {
                        "key_as_string": "1576108800000",
                        "key": 1576108800000,
                        "doc_count": 534348,
                        "1": {
                            "value": 3.10282260467253E14
                        }
                    },
                    {
                        "key_as_string": "1576713600000",
                        "key": 1576713600000,
                        "doc_count": 462154,
                        "1": {
                            "value": 3.17786606973172E14
                        }
                    },
                    {
                        "key_as_string": "1577318400000",
                        "key": 1577318400000,
                        "doc_count": 428751,
                        "1": {
                            "value": 2.48661117736505E14
                        }
                    },
                    {
                        "key_as_string": "1577923200000",
                        "key": 1577923200000,
                        "doc_count": 424834,
                        "1": {
                            "value": 3.0074272972544E14
                        }
                    },
                    {
                        "key_as_string": "1578528000000",
                        "key": 1578528000000,
                        "doc_count": 523675,
                        "1": {
                            "value": 4.16085519113989E14
                        }
                    },
                    {
                        "key_as_string": "1579132800000",
                        "key": 1579132800000,
                        "doc_count": 511959,
                        "1": {
                            "value": 3.56938264801624E14
                        }
                    }
                ]
            }
        },
        {
            "key": "San Diego Supercomputer Center",
            "doc_count": 3413874,
            "1": {
                "value": 1.9956460697131352E16
            },
            "2": {
                "buckets": [
                    {
                        "key_as_string": "1574294400000",
                        "key": 1574294400000,
                        "doc_count": 83984,
                        "1": {
                            "value": 5.4510721761138E13
                        }
                    },
                    {
                        "key_as_string": "1574899200000",
                        "key": 1574899200000,
                        "doc_count": 254149,
                        "1": {
                            "value": 2.20422708058775E14
                        }
                    },
                    {
                        "key_as_string": "1575504000000",
                        "key": 1575504000000,
                        "doc_count": 702187,
                        "1": {
                            "value": 5.82341759986351E14
                        }
                    },
                    {
                        "key_as_string": "1576108800000",
                        "key": 1576108800000,
                        "doc_count": 388050,
                        "1": {
                            "value": 2.38111609642884E14
                        }
                    },
                    {
                        "key_as_string": "1576713600000",
                        "key": 1576713600000,
                        "doc_count": 371421,
                        "1": {
                            "value": 2.83581743107484E14
                        }
                    },
                    {
                        "key_as_string": "1577318400000",
                        "key": 1577318400000,
                        "doc_count": 362474,
                        "1": {
                            "value": 2.18813782791195E14
                        }
                    },
                    {
                        "key_as_string": "1577923200000",
                        "key": 1577923200000,
                        "doc_count": 406776,
                        "1": {
                            "value": 2.36667472797821E14
                        }
                    },
                    {
                        "key_as_string": "1578528000000",
                        "key": 1578528000000,
                        "doc_count": 469881,
                        "1": {
                            "value": 2.53686458422201E14
                        }
                    },
                    {
                        "key_as_string": "1579132800000",
                        "key": 1579132800000,
                        "doc_count": 374952,
                        "1": {
                            "value": 4.0642133057357E14
                        }
                    }
                ]
            }
        },
        {
            "key": "Amazon.com, Inc.",
            "doc_count": 30094759,
            "1": {
                "value": 1.9183461563884512E16
            },
            "2": {
                "buckets": [
                    {
                        "key_as_string": "1574294400000",
                        "key": 1574294400000,
                        "doc_count": 2652336,
                        "1": {
                            "value": 1.21266174225165E14
                        }
                    },
                    {
                        "key_as_string": "1574899200000",
                        "key": 1574899200000,
                        "doc_count": 4659727,
                        "1": {
                            "value": 2.92514972414325E14
                        }
                    },
                    {
                        "key_as_string": "1575504000000",
                        "key": 1575504000000,
                        "doc_count": 5201822,
                        "1": {
                            "value": 5.48847432821879E14
                        }
                    },
                    {
                        "key_as_string": "1576108800000",
                        "key": 1576108800000,
                        "doc_count": 3256544,
                        "1": {
                            "value": 3.50292583267243E14
                        }
                    },
                    {
                        "key_as_string": "1576713600000",
                        "key": 1576713600000,
                        "doc_count": 1298620,
                        "1": {
                            "value": 1.60120145511722E14
                        }
                    },
                    {
                        "key_as_string": "1577318400000",
                        "key": 1577318400000,
                        "doc_count": 1053422,
                        "1": {
                            "value": 8.3156917719596E13
                        }
                    },
                    {
                        "key_as_string": "1577923200000",
                        "key": 1577923200000,
                        "doc_count": 3200767,
                        "1": {
                            "value": 2.21922421682632E14
                        }
                    },
                    {
                        "key_as_string": "1578528000000",
                        "key": 1578528000000,
                        "doc_count": 5455033,
                        "1": {
                            "value": 3.68069624445091E14
                        }
                    },
                    {
                        "key_as_string": "1579132800000",
                        "key": 1579132800000,
                        "doc_count": 3316488,
                        "1": {
                            "value": 2.51742423397911E14
                        }
                    }
                ]
            }
        },
        {
            "key": "Brookhaven National Laboratory",
            "doc_count": 2629385,
            "1": {
                "value": 1.8758750657305128E16
            },
            "2": {
                "buckets": [
                    {
                        "key_as_string": "1574294400000",
                        "key": 1574294400000,
                        "doc_count": 142310,
                        "1": {
                            "value": 9.2592639257088E13
                        }
                    },
                    {
                        "key_as_string": "1574899200000",
                        "key": 1574899200000,
                        "doc_count": 268744,
                        "1": {
                            "value": 2.70834644689544E14
                        }
                    },
                    {
                        "key_as_string": "1575504000000",
                        "key": 1575504000000,
                        "doc_count": 308474,
                        "1": {
                            "value": 2.931104679424E14
                        }
                    },
                    {
                        "key_as_string": "1576108800000",
                        "key": 1576108800000,
                        "doc_count": 429134,
                        "1": {
                            "value": 3.55519387809226E14
                        }
                    },
                    {
                        "key_as_string": "1576713600000",
                        "key": 1576713600000,
                        "doc_count": 290299,
                        "1": {
                            "value": 2.86630566631424E14
                        }
                    },
                    {
                        "key_as_string": "1577318400000",
                        "key": 1577318400000,
                        "doc_count": 324799,
                        "1": {
                            "value": 2.14929162166272E14
                        }
                    },
                    {
                        "key_as_string": "1577923200000",
                        "key": 1577923200000,
                        "doc_count": 309342,
                        "1": {
                            "value": 3.25427047468275E14
                        }
                    },
                    {
                        "key_as_string": "1578528000000",
                        "key": 1578528000000,
                        "doc_count": 360120,
                        "1": {
                            "value": 3.0805393477888E14
                        }
                    },
                    {
                        "key_as_string": "1579132800000",
                        "key": 1579132800000,
                        "doc_count": 196163,
                        "1": {
                            "value": 1.97745981420032E14
                        }
                    }
                ]
            }
        },
        {
            "key": "Massachusetts Institute of Technology",
            "doc_count": 1988584,
            "1": {
                "value": 1.828111498387312E16
            },
            "2": {
                "buckets": [
                    {
                        "key_as_string": "1574294400000",
                        "key": 1574294400000,
                        "doc_count": 99619,
                        "1": {
                            "value": 9.9854977975809E13
                        }
                    },
                    {
                        "key_as_string": "1574899200000",
                        "key": 1574899200000,
                        "doc_count": 172492,
                        "1": {
                            "value": 8.768645056276E13
                        }
                    },
                    {
                        "key_as_string": "1575504000000",
                        "key": 1575504000000,
                        "doc_count": 75870,
                        "1": {
                            "value": 2.7574005195424E13
                        }
                    },
                    {
                        "key_as_string": "1576108800000",
                        "key": 1576108800000,
                        "doc_count": 277209,
                        "1": {
                            "value": 3.24953110483894E14
                        }
                    },
                    {
                        "key_as_string": "1576713600000",
                        "key": 1576713600000,
                        "doc_count": 189872,
                        "1": {
                            "value": 1.066392323968E14
                        }
                    },
                    {
                        "key_as_string": "1577318400000",
                        "key": 1577318400000,
                        "doc_count": 100234,
                        "1": {
                            "value": 6.569805823488E13
                        }
                    },
                    {
                        "key_as_string": "1577923200000",
                        "key": 1577923200000,
                        "doc_count": 375556,
                        "1": {
                            "value": 5.9342995714912E14
                        }
                    },
                    {
                        "key_as_string": "1578528000000",
                        "key": 1578528000000,
                        "doc_count": 339732,
                        "1": {
                            "value": 4.30362049885184E14
                        }
                    },
                    {
                        "key_as_string": "1579132800000",
                        "key": 1579132800000,
                        "doc_count": 358000,
                        "1": {
                            "value": 5.48941531100269E14
                        }
                    }
                ]
            }
        },
        {
            "key": "ESnet",
            "doc_count": 3909347,
            "1": {
                "value": 1.700206375678108E16
            },
            "2": {
                "buckets": [
                    {
                        "key_as_string": "1574294400000",
                        "key": 1574294400000,
                        "doc_count": 110749,
                        "1": {
                            "value": 8.4834542794333E13
                        }
                    },
                    {
                        "key_as_string": "1574899200000",
                        "key": 1574899200000,
                        "doc_count": 359468,
                        "1": {
                            "value": 2.37205351307827E14
                        }
                    },
                    {
                        "key_as_string": "1575504000000",
                        "key": 1575504000000,
                        "doc_count": 495140,
                        "1": {
                            "value": 2.9605966017221E14
                        }
                    },
                    {
                        "key_as_string": "1576108800000",
                        "key": 1576108800000,
                        "doc_count": 485752,
                        "1": {
                            "value": 2.51769382409458E14
                        }
                    },
                    {
                        "key_as_string": "1576713600000",
                        "key": 1576713600000,
                        "doc_count": 467118,
                        "1": {
                            "value": 2.41312971881927E14
                        }
                    },
                    {
                        "key_as_string": "1577318400000",
                        "key": 1577318400000,
                        "doc_count": 419610,
                        "1": {
                            "value": 2.25165489619172E14
                        }
                    },
                    {
                        "key_as_string": "1577923200000",
                        "key": 1577923200000,
                        "doc_count": 531319,
                        "1": {
                            "value": 2.79617490308093E14
                        }
                    },
                    {
                        "key_as_string": "1578528000000",
                        "key": 1578528000000,
                        "doc_count": 571930,
                        "1": {
                            "value": 2.78092392460777E14
                        }
                    },
                    {
                        "key_as_string": "1579132800000",
                        "key": 1579132800000,
                        "doc_count": 468261,
                        "1": {
                            "value": 2.31200688643838E14
                        }
                    }
                ]
            }
        }
    ]
}

let parsed_data = []

console.log(data)

// extract raw data by org
for (i in data.buckets) {
    org = data.buckets[i].key;
    parsed_data[i] = {"org": org, "data": []};
    let inner_buckets = data.buckets[i][2].buckets;
    for (j in inner_buckets) {
        date = inner_buckets[j].key;
        value = inner_buckets[j][1].value;
        parsed_data[i].data[j] = {"date": date, "value": value, "rank": 0, "orig_index": parseInt(i)}
    }
}

console.log(parsed_data)

// assign ranks to data
for (i in parsed_data[0].data) {
    let temp_array = []
    for (j in parsed_data) {
        temp_array[j] = parsed_data[j].data[i]
    }
    temp_array.sort((a,b) => { return b.value - a.value })
    console.log(temp_array)
    for (let k = 0; k < temp_array.length; k++) {
        parsed_data[temp_array[k].orig_index].data[i].rank = k
    }
}
console.log("new data")
console.log(parsed_data)

let colorPal = ["rgba(223, 79, 79, 0.5)",
    "rgba(88, 223, 79, 0.5)",
    "rgba(79, 145, 223, 0.5)",
    "rgba(223, 79, 168, 0.5)",
    "rgba(223, 155, 79, 0.5)",
    "rgba(79, 223, 192, 0.5)",
    "rgba(138, 79, 223, 0.5)",
    "rgba(166, 223, 79, 0.5)",
    "rgba(147, 50, 55, 0.5)",
    "rgba(50, 147, 142, 0.5)",
    "rgba(59, 147, 50, 0.5)",
    "rgba(94, 50, 147, 0.5)",
    "rgba(147, 78, 50, 0.5)",
    "rgba(50, 81, 147, 0.5)"]

// add color and org to first data point, just org to last data point

for (i in parsed_data) {
    parsed_data[i].data[0].org = parsed_data[i].org
    parsed_data[i].data[parsed_data[i].data.length - 1].org = parsed_data[i].org
    parsed_data[i].data[0].color = colorPal[i % colorPal.length]
}

// Starting pos = parsed_data[i].org
// Find final positions
let final_positions = [];
for (i in parsed_data) {
    let last = parsed_data[i].data[parsed_data[i].data.length - 1];
    final_positions[i] = {org: last.org,
                        rank: last.rank}
}
final_positions.sort((a, b) => { return a.rank - b.rank })



/////////////////////////////////////Make the Viz/////////////////////////////////////////////////////////////

// set the dimensions and margins of the graph
var margin = { top: 50, right: 250, bottom: 50, left: 100, spacer: 25 },
    width = 1500 - margin.left - margin.right,
    height = 500 - margin.top - margin.bottom;

// append the svg object to the body of the page
var svg = d3.select("#chart-area")
    .append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom + margin.spacer)
    .append("g")
    .attr("height", height)
    .attr("transform",
        "translate(" + margin.left + "," + margin.top + ")");

// function to wrap text!
function wrap(text, width) {
    text.each(function () {
        var text = d3.select(this),
            words = text.text().split(/\s+/).reverse(),
            word,
            line = [],
            lineNumber = 0,
            lineHeight = 1.1, // ems
            y = text.attr("y"),
            dy = parseFloat(text.attr("dy")),
            tspan = text.text(null).append("tspan").attr("x", 0).attr("y", y).attr("dy", dy + "em");
        while (word = words.pop()) {
            line.push(word);
            tspan.text(line.join(" "));
            if (tspan.node().getComputedTextLength() > width) {
                line.pop();
                tspan.text(line.join(" "));
                line = [word];
                tspan = text.append("tspan").attr("x", 0).attr("y", y).attr("dy", ++lineNumber * lineHeight + dy + "em").text(word);
            }
        }
    });
}

// the date range of available data:
var dataXrange = d3.extent(parsed_data[0].data, function (d) { return d.date; });
var dataYrange = [0, 9];

// maximum date range allowed to display
var mindate = dataXrange[0],  // use the range of the data
    maxdate = dataXrange[1];

// timestamp formatter

var dateFormat = d3.timeFormat("%m/%d/%Y");


// Add X scale
var x = d3.scaleTime()
    .domain(dataXrange)
    .range([0, width])


// Add Y scale
var y = d3.scaleLinear()
    .domain(dataYrange)
    .range([0, height])

// var leftAxis = d3.axisLeft(y)
//     .tickSize(5)
//     .tickFormat((d) => {
//         return parsed_data[d].org
//     })

// Add axes
var rightAxis = d3.axisRight(y)
    .tickSize(5)
    .tickFormat((d) => {
        return final_positions[d].org
    })

var bottomAxis = d3.axisBottom(x)
    .tickSize(5)
    .tickFormat(dateFormat)

svg.append("g").call(rightAxis)
    .attr("margin", 10)
    .attr("transform", "translate(" + width + "," + margin.spacer + ")")
    .selectAll(".tick text")
    .call(wrap, margin.right - 25)
    .attr("transform", "translate(" + 10 + ",0)")

svg.append("g")
    .call(bottomAxis)
    .attr("class", "axis")
    .attr("transform", "translate(0," + (height + margin.spacer + margin.bottom/2) + ")")
    .selectAll(".tick text")
    .call(wrap, 100)
    


// // width scale
// var w = d3.scaleLinear()
//     .domain([top_10_pairs[top_10_pairs.length - 1][2], top_10_pairs[0][2]])
//     .range([1, 10])

var div = d3.select("body").append("div")
    .attr("class", "tooltip")
    .style("opacity", 0);


// Add the lines
for (i in parsed_data) {

    svg.append("svg")
        .attr("width", width)
        .attr("height", height + margin.bottom)
        .append("g")
        .attr("transform", "translate(0," + margin.spacer + ")")
        .append("path")
        .datum(parsed_data[i].data)
        .attr("fill", "none")
        .attr("stroke", colorPal[i % colorPal.length])
        .attr("stroke-width", 7)
        .attr("d", d3.line()
            .x(function (d) { return x(d.date) })
            .y(function (d) { return y(d.rank) }))
        .on("mouseover", function (d) {
            d3.select(this).attr("stroke", () => {
                var hover_color = d[0].color;
                var index = hover_color.lastIndexOf(",");
                hover_color = hover_color.substring(0, index) + ", 1.0)"
                console.log("hover color: " + hover_color);
                return hover_color;
            })
            div.transition()
                .duration(200)
                .style("opacity", .9);
            div.html(() => {
                var text = "<p><b>Organization:</b></p>" + d[0].org;
                return text;
            })
                .style("left", (d3.event.pageX) + "px")
                .style("top", (d3.event.pageY - 28) + "px")
        })
        .on("mouseout", function (d) {
            div.transition()
                .duration(500)
                .style("opacity", 0);
            d3.select(this).attr("stroke", () => {
                return d[0].color;
            })
        })
    ///////////////////////
    // Nodes
    var node = svg.append("svg")
        .attr("width", width + 10)
        .attr("height", height + margin.bottom)
        .append("g")
        .attr("transform", "translate(0," + margin.spacer + ")")
        .selectAll("circle")
        .data(parsed_data[i].data)
        .enter().append("circle")
        .attr("class", "point")
        .attr("cx", function (d) { return x(d.date); })
        .attr("cy", function (d) { return y(d.rank); })
        .attr('fill', colorPal[i % colorPal.length])
        // .attr("class", function (d) { return d['club'].toLowerCase().replace(/ /g, '-').replace(/\./g, '') })
        .attr("r", 7)
        //.attr("r", function(d) { return size(d['goals_for']) })
        .attr("stroke-width", 1.5)
        .attr('opacity', '0.6');
}



///////////////////////
// Tooltips
// var tooltip = d3.select("body").append("div")
//     .attr("class", "tooltip");

// svg.selectAll("circle")
//     .on("mouseover", function (d) {
//         chart.selectAll('.' + d['class'])
//             .classed('active', true);

//         var tooltip_str = "Club: " + d['club'] +
//             "<br/>" + "Year: " + d['year'] +
//             "<br/>" + "Points: " + d['points'] +
//             "<br/>" + "W/L/T: " + d['wins'] + " / " + d['losses'] + " / " + d['ties'] +
//             "<br/>" + "Goals F/A: " + d['goals_for'] + " / " + d['goals_against'];

//         if (d['alias'] != '') {
//             tooltip_str += "<br/>(aka: " + d['alias'] + ")";
//         }

//         tooltip.html(tooltip_str)
//             .style("visibility", "visible");
//     })
//     .on("mousemove", function (d) {
//         tooltip.style("top", event.pageY - (tooltip.node().clientHeight + 5) + "px")
//             .style("left", event.pageX - (tooltip.node().clientWidth / 2.0) + "px");
//     })
//     .on("mouseout", function (d) {
//         chart.selectAll('.' + d['class'])
//             .classed('active', false);

//         tooltip.style("visibility", "hidden");
//     })
//     .on('click', function (d) {
//         chart.selectAll('.' + d['class'])
//             .classed('click-active', function (d) {
//                 // toggle state
//                 return !d3.select(this).classed('click-active');
//             });
//     })

